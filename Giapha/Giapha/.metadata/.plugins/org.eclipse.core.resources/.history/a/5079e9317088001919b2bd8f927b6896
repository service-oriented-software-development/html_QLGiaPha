package jsoft.ads.individual;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import Common.ConnectionPool;
import jsoft.ads.basic.BasicImpl;
import jsoft.ads.object.IndividualObject;

public class IndividualImpl extends BasicImpl implements Individual {

	public IndividualImpl(ConnectionPool cp) {
		super(cp, "FamilyTree");
		// TODO Auto-generated constructor stub
	}

	public boolean addFamilyTree(IndividualObject item) {
		String sql = "insert giaphahole values(?,?,?,?)";
		PreparedStatement pre;
		try {
			pre = this.con.prepareStatement(sql);
			pre.setInt(1, item.getKhoa());
			pre.setString(2, item.getTen());
			pre.setInt(3, item.getCha());
			pre.setString(4, item.getNhanh());
			return this.add(pre);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return false;
	}

	public boolean editFamilyTree(IndividualObject item) {
		// TODO Auto-generated method stub
		return false;
	}

	public boolean delFamilyTree(IndividualObject item) {
		String sql = "delete giaphahole where khoa=?";
		PreparedStatement pre;
		try {
			pre = this.con.prepareStatement(sql);
			pre.setInt(1, item.getKhoa());

			return this.del(pre);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return false;
	}

	public ResultSet getFamilyTrees() {
		String sql = "select * from giaphahole ";
		sql += "order by nhanh";
		return this.get(sql);
	}

	public ResultSet getFamilyTrees(IndividualObject similar, int at, byte total) {
		String sql = "select * from giaphahole ";
		sql += "Limit" + at + "," + total;
		return this.get(sql);
	}

	public ResultSet getFamilyTree(int id) {
		String sql = "select * from giaphahole where khoa=?";
		return this.get(sql, id);
	}

	public ResultSet getChild(int id) {
		String sql = "select * from giaphahole where cha=?";
		return this.get(sql, id);
	}

	

}
